# Splunk Props Configuration for XDR
# 경로: $SPLUNK_HOME/etc/apps/xdr_platform/local/props.conf

#############################################
# Windows Event Log
#############################################
[WinEventLog:Security]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%:z
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = xml
TRANSFORMS-set_sourcetype = set_windows_security_sourcetype

[WinEventLog:System]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%:z
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = xml

[WinEventLog:Microsoft-Windows-Sysmon/Operational]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%:z
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = xml

#############################################
# EDR Logs
#############################################
[xdr:edr:process]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 30
KV_MODE = json
TRUNCATE = 100000

[xdr:edr:network]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 30
KV_MODE = json

[xdr:edr:file]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 30
KV_MODE = json

#############################################
# NDR Logs - Zeek
#############################################
[zeek:conn]
SHOULD_LINEMERGE = false
TIME_FORMAT = %s.%6N
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
INDEXED_EXTRACTIONS = json
KV_MODE = none

[zeek:dns]
SHOULD_LINEMERGE = false
TIME_FORMAT = %s.%6N
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
INDEXED_EXTRACTIONS = json
KV_MODE = none

[zeek:http]
SHOULD_LINEMERGE = false
TIME_FORMAT = %s.%6N
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
INDEXED_EXTRACTIONS = json
KV_MODE = none

[zeek:ssl]
SHOULD_LINEMERGE = false
TIME_FORMAT = %s.%6N
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
INDEXED_EXTRACTIONS = json
KV_MODE = none

#############################################
# NDR Logs - Suricata
#############################################
[suricata:alert]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%z
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 35
KV_MODE = json

#############################################
# Threat Intelligence
#############################################
[xdr:threat_intel]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3NZ
TIME_PREFIX = "timestamp"\s*:\s*"
KV_MODE = json
